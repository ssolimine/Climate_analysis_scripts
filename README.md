# Climate analysis scripts

This repository contains a representative subset of scripts developed during my doctoral research on precipitation variability, deep convection, and quasi two-day westward-propagating inertio-gravity (WIG) waves in equatorial Africa.

The scripts demonstrate end-to-end scientific workflows, including satellite and reanalysis data ingestion, spatial resampling, temporal alignment, statistical analysis, machine learning, and visualization to isolate physically meaningful signals, quantify uncertainty, and analyze complex spatiotemporal atmospheric processes.

# Scripts included

Each script contains a header explaining their functionality in more detail

- 'XGBoost_wave_analysis.py' - A supervised machine learning model using XGBoost Regressor for classifying feature importance relative to two-day WIG wave passage
- 'WIG_precipitation_analysis_Congo.py' - Calculates and visualizes precipitation variability associated with two-day WIG waves and their climatology in equatorial Africa
- 'Spatial_lag_regression.py' - Calculates spatial lagged regressions of specific ERA5 variables against two-day WIG filtered cloud top brightness temperatures
- 'Time-height_lag_regression.py' - Calculates time-height lagged regressions of specific ERA5 variables against two-day WIG filtered cloud top brightness temperatures
- 'MSWEP_to_monthly_netcdf.py' - Takes individual 3-hourly MSWEP precipitation data files for specified time period and organizes contents into monthly NetCDF files with a 3-hourly time step
- 'goes16_downloader.py' - Downloads specified GOES-16 satellite imagery products
- 'Grid_resampling_script.py' - Resamples the spatial grids of ERA5 and MSWEP precipitation datasets onto the CLAUS dataset grid

Sample figures generated by some of the scripts above are stored in the 'figures/' directory. Each subfolder corresponds to the script that generated the plot(s).

## Requirements 
These scripts were developed using Python 3.10.x
It's recommended to use Python 3.10 or a virtual environment with the appropriate dependencies to ensure reproducibility. 

# Sample text output 

Text output is associated with the same script runs which produced the corresponding sample plots

'XGBoost_wave_analysis.py'

<pre>===== Wave Intensity Summary (Overall) =====
Minimum wave intensity: -27.4399
Maximum wave intensity: 38.9166
Mean wave intensity: 0.2060
Standard deviation: 13.2007

===== Wave Intensity Summary (Training Set) =====
Training Set Size: 1619 samples
Mean wave intensity: 0.4102
Standard deviation: 13.1973

===== Wave Intensity Summary (Test Set) =====
Test Set Size: 405 samples
Mean wave intensity: -0.6101
Standard deviation: 13.1992

===== Model Performance on Test Data =====
RMSE: 9.9817
R² Score: 0.4267
MAE: 7.9043</pre>

'Spatial_lag_regression.py'

Wave phase speed = -20.12 m/s (This represents WIG wave phase speed; negative values indicate westward propagation)

# SHAP plot interpretation

The SHAP summary plot illustrates the impact of each input feature (ERA5 variable) on the model’s predictions across all samples. Features are listed on the Y-axis in order of importance. Features near the top have the highest overall impact on the model output. The X-axis represents the SHAP value which shows how much that feature contributed to pushing the prediction higher (right) or lower (left). Each dot represents one datapoint and the color corresponds to the normalized feature value (red = high, blue = low). If red dots are mostly to the right and blue to the left, high values of that feature push the prediction up, and low values push it down. If the spread is symmetric, the feature has a non-directional or complex influence.

# Note

This code is provided as-is for educational and illustrative purposes. Scripts are domain-specific and may not generalize without adaptation to other similar datasets or regions. The Cloud Archive User Service (CLAUS) project dataset was used for the filtering of WIG waves. The datasets used in these scripts were cleaned and pre-processed before use. For example, all ERA5, MSWEP, and CLAUS data were interpolated onto a shared spatial grid in order to make comparisons and accurate statistical calculations across datasets.
